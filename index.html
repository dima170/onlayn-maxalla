<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Onlayn Mahalla</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h2 id="welcome">Загрузка...</h2>
<div id="registration">
  <h2>Регистрация</h2>
  <input type="text" id="name" placeholder="Имя"><br><br>
  <input type="tel" id="phone" placeholder="Телефон"><br><br>
  <button onclick="sendData()">Зарегистрироваться</button>
</div>

<script>
  function sendData() {
    const name = document.getElementById("name").value;
    const phone = document.getElementById("phone").value;

    const data = {
      name: name,
      phone: phone
    };

    if (window.Telegram && Telegram.WebApp) {
      Telegram.WebApp.sendData(JSON.stringify(data));
      Telegram.WebApp.close(); // Закрывает WebApp после отправки
    } else {
      alert("Открой через Telegram, а не браузер.");
    }
  }
</script>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();  // Разворачивает WebApp

        const user = tg.initDataUnsafe.user;

        if (user) {
            const name = user.first_name + " " + (user.last_name || "");
            document.getElementById("welcome").innerText = "Ассалому алайкум, " + name + "!";

            const userData = {
                id: user.id,
                name: name,
                username: user.username
            };

            // пока без сервера, но можно отправить на backend:
            console.log("Регистрация:", userData);
        } else {
            document.getElementById("welcome").innerText = "Пожалуйста, откройте сайт через Telegram-бота.";
        }
    </script>
</body>
</html>
